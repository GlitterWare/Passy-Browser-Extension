cd $(dirname $0)
cat ./web/manifest.json | jq 'del(.key)' | jq 'del(.background.service_worker)' | jq '. + {"browser_specific_settings": {"gecko": {"id": "glitterware.passy_browser_extension@github.io"}}}' | jq '.background += {"scripts": ["background.js"]}' | jq '.action.default_popup = "popup.html"' | jq '.manifest_version = 2' | jq '.content_security_policy = .content_security_policy.extension_pages' | jq '.browser_action = .action' | jq 'del(.action)' | jq '.browser_action.default_icon = .icons' | jq '.web_accessible_resources[0].resources += .web_accessible_resources[0].matches' | jq '.web_accessible_resources = .web_accessible_resources[0].resources' > web/manifest_firefox.json
